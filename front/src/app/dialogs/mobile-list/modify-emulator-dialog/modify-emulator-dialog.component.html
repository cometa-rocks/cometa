<draggable-window></draggable-window>
<form [formGroup]="">
  <ng-container>
    <h2 mat-dialog-title>Edit Mobile Device</h2>
  </ng-container>
  <mat-dialog-content>
    <mat-accordion multi>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <span>Information</span>
          </mat-panel-title>
          <mat-panel-description></mat-panel-description>
        </mat-expansion-panel-header>
        <ng-template matExpansionPanelContent>
          <div class="edit-feature-info">
            <mat-form-field appearance="fill" class="edit-dep">
              <mat-label>Department</mat-label>
              <mat-label> {{ data.department_name }} </mat-label>
            </mat-form-field>
            <mat-form-field appearance="fill" class="edit-app">
              <mat-label>Application</mat-label>
              <mat-select
                [(ngModel)]="selected_application"
                formControlName="app_name"
                (focus)="onInputFocus()"
                (blur)="onInputBlur()">

              </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="edit-env">
              <mat-label>Environment</mat-label>
              <mat-select
                [(ngModel)]="selected_environment"
                formControlName="environment_name"
                (focus)="onInputFocus()"
                (blur)="onInputBlur()">
                <mat-option
                  *ngFor="let env of environments$ | sortBy: 'environment_name'"
                  [value]="env.environment_name">
                  {{ env.environment_name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="edit-name">
              <mat-label>Name</mat-label>
              <input
                matInput
                spellcheck="false"
                formControlName="feature_name"
                (focus)="onInputFocus()"
                (blur)="onInputBlur()"
                />
            </mat-form-field>
            <mat-form-field appearance="fill" class="edit-description">
              <mat-label>Description</mat-label>
              <textarea
                spellcheck="false"
                formControlName="description"
                matInput
                rows="1"
                (focus)="onInputFocus()"
                (blur)="onInputBlur()"
                ></textarea>
            </mat-form-field>
          </div>
          <div
            *ngIf="selected_department === 'Default' && departments$.length > 1"
            class="department-warning">
            <mat-icon>info</mat-icon>
            <span
              >Selecting <strong>Default</strong> department will make this
              feature visible to everyone, use it with caution!</span
            >
          </div>
          <div class="depends">
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <mat-checkbox color="primary" formControlName="depends_on_others" [matTooltip]="'edit_feature.depends_on_other_feature' | translate" matTooltipPosition="above">
                Depends on other feature
              </mat-checkbox>
              <div class="hover-box">(D)</div>
            </div>
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <mat-checkbox color="primary" formControlName="send_mail" [matTooltip]="'edit_feature.send_mail' | translate" matTooltipPosition="above">
                Send email on finish
              </mat-checkbox>
              <div class="hover-box">(M)</div>
            </div>
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <mat-checkbox color="primary" *ngIf="!featureForm.value.depends_on_others" formControlName="video" [matTooltip]="'edit_feature.record_video' | translate" matTooltipPosition="above">
                Record video
              </mat-checkbox>
              <div class="hover-box">(R)</div>
            </div>
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <mat-checkbox
                color="primary"
                *ngIf="!featureForm.value.depends_on_others"
                formControlName="network_logging"
                [matTooltip]="'edit_feature.network_logging' | translate" matTooltipPosition="above">
                Network Logging
              </mat-checkbox>
              <div class="hover-box">(N)</div>
            </div>
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <mat-checkbox
                color="primary"
                *ngIf="!featureForm.value.depends_on_others"
                formControlName="generate_dataset"
                [matTooltip]="'edit_feature.generate_dataset' | translate" matTooltipPosition="above">
                Generate Dataset
              </mat-checkbox>
              <div class="hover-box">(G)</div>
            </div>
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <ng-container *ngLet="((departmentSettings$ | async)?.continue_on_failure || user.settings?.continue_on_failure) as disabled">
                <mat-checkbox [matTooltip]="'continue_on_failure.tooltip' | translate" [matTooltipDisabled]="!disabled" color="primary" [disabled]="disabled" formControlName="continue_on_failure">
                  Continue on failures
                </mat-checkbox>
                <div class="hover-box">(F)</div>
              </ng-container>
            </div>
            <div class="checkbox-container" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()">
              <mat-checkbox color="primary" formControlName="need_help" [matTooltip]="'edit_feature.explanation' | translate" matTooltipPosition="above">{{ 'need_help.ask_for' | translate }}</mat-checkbox>
              <div class="hover-box">(H)</div>
            </div>
            <ng-container *ngLet="(!featureForm.value.environment_name || !featureForm.value.department_name) as disableVariables">
              <div class="checkbox-container move-right">
                <span class="edit-variables" [matTooltip]="'tooltips.variables_requires' | translate" [matTooltipDisabled]="!disableVariables">
                  <button color="primary"
                  [disabled]="disableVariables"
                  (click)="editVariables()"
                  mat-stroked-button
                  [matTooltip]="'edit_feature.edit_variable' | translate" matTooltipPosition="above">
                    Edit Variables
                  </button>
                </span>
                <div class="hover-box-Vshortcut">(V)</div>
              </div>
            </ng-container>
            <ng-container>
              <div *ngIf="configValueBoolean" class="checkbox-container move-right">
                <span class="edit-variables" [matTooltip]="'tooltips.variables_requires' | translate" [matTooltipDisabled]="!disableVariables">
                  <div class="button-container">
                    <button
                      color="primary"
                      [disabled]="disableVariables"
                      (click)="openStartEmulatorScreen()"
                      mat-stroked-button
                      [matTooltip]="'mobile_list.emulator_mobile' | translate"
                      matTooltipPosition="above">
                      Start Mobile
                    </button>
                    <mat-icon
                      class="memberShip"
                      [matTooltip]="'To use this functionality, you need to purchase a Cometa license.'">
                      card_membership
                    </mat-icon>
                  </div>
                </span>
                <div class="hover-box-Vshortcut">(S)</div>
              </div>
            </ng-container>
          </div>
        </ng-template>
      </mat-expansion-panel>

    </mat-accordion>
  </mat-dialog-content>
</form>
